PROCESS_ID=ADR
MAX_ROWS=500000
FILE_SUBSTR_DATE_FORMAT=YYYYMMddHHmmSS
DATE_FORMAT=dd/MM/yyyy
DATE_TIME_FORMAT=dd/MM/yy HH24:mi:ss
SUMMARY_FILE_REQUIRED=N


ADR_DIR=<TOMCAT-PATH>/logs/ADR_Final_Data/
ADR_HEADER=Date and Time of Dump,Channel user MSISDN,Category name,Total count of C2C transactions,Total amount of C2C transactions,Total count of C2S transactions,Total amount of C2S transactions,Current Balance
ADR_QRY=select from_msisdn,category_name,sum(c2s_count) c2s_count,sum(c2s_amount) c2s_amount,sum(c2c_count) c2c_count,sum(c2c_amount) c2c_amount,current_balance from (SELECT up.msisdn from_msisdn, cat.category_name, COUNT (c2strans.transfer_id) c2s_count,  SUM(c2strans.transfer_value) c2s_amount,0 C2C_COUNT,0 C2C_AMOUNT, ub.balance current_balance FROM c2s_transfers c2strans,user_phones up,users u,products p,categories cat,user_balances ub WHERE u.user_id=c2strans.sender_id AND  u.user_id= up.user_id AND u.status in('Y','S') AND c2strans.transfer_date = trunc(?) AND  c2strans.transfer_date_time <  ? AND c2strans.transfer_status = '200' AND c2strans.transfer_type = 'TXN' AND p.product_code = c2strans.product_code AND cat.category_code = c2strans.sender_category AND  u.user_id = ub.user_id AND ub.product_code =  P.product_code GROUP BY  up.msisdn ,c2strans.transfer_date,cat.category_name , ub.balance union SELECT up.msisdn from_msisdn,SEND_CAT.category_name, 0 C2S_COUNT,0 C2S_AMOUNT,count(*)C2C_COUNT,SUM(CTI.required_quantity) C2C_AMOUNT,  ub.balance current_balance FROM CHANNEL_TRANSFERS CTRF, CHANNEL_TRANSFERS_ITEMS CTI,USERS FU,PRODUCTS P,LOOKUPS L, LOOKUPS L1, CATEGORIES SEND_CAT, user_balances ub,user_phones up WHERE CTRF.TYPE = 'C2C' AND CTRF.transfer_date = trunc(?)  AND NVL(CTRF.close_date,CTRF.created_on) <  ? AND CTRF.network_code ='BD' AND CTRF.control_transfer<>'A' AND CTRF.sender_category_code = SEND_CAT.category_code AND FU.user_id = CTRF.from_user_id AND up.user_id =FU.user_id AND FU.status in('Y','S') AND CTRF.transfer_id = CTI.transfer_id AND CTI.product_code = P.product_code AND L.lookup_type ='TRFT' AND L.lookup_code = CTRF.transfer_sub_type AND L.lookup_code ='T' AND CTRF.status = 'CLOSE' AND L1.lookup_code = CTRF.status AND L1.lookup_type = 'CTSTA' AND CTRF.from_user_id= ub.user_id AND ub.product_code =  P.product_code GROUP BY   FU.user_name, up.msisdn,L.lookup_name , CTRF.TYPE, CTRF.transfer_date,P.product_name, L1.lookup_name,SEND_CAT.category_name , ub.balance  union select up.msisdn from_msisdn ,cat.category_name , 0 C2S_COUNT,0 C2S_AMOUNT,0 C2C_COUNT,0 C2C_AMOUNT,  ub.balance current_balance from users u,user_phones up, categories cat , user_balances ub ,PRODUCTS P where up.user_id =u.user_id AND u.category_code=cat.category_code AND cat.status ='Y' AND u.user_id=ub.user_id AND u.status in('Y','S') AND ub.product_code =  P.product_code AND p.status='Y' AND u.user_type ='CHANNEL' AND u.network_code='BD')Mast  group by Mast.from_msisdn,Mast.category_name,Mast.current_balance;

ADR_EXT=.csv
ADR_PREFIX_NAME=ADR_
